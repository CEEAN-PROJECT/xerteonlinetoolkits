<script type="text/javascript">
    /**
     * Licensed to The Apereo Foundation under one or more contributor license
     * agreements. See the NOTICE file distributed with this work for
     * additional information regarding copyright ownership.

     * The Apereo Foundation licenses this file to you under the Apache License,
     * Version 2.0 (the "License"); you may not use this file except in
     * compliance with the License. You may obtain a copy of the License at:
     *
     * http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

     * See the License for the specific language governing permissions and
     * limitations under the License.
     */

    var textCorrection = new function() {
            this.pageChanged = function() {

            };

            this.sizeChanged = function() {

            };

            this.init = function() {

                var panelWidth = x_currentPageXML.getAttribute("panelWidth"),
                    $splitScreen = $("#pageContents .splitScreen");
                var $textHolder = $("#textHolder");

                if (panelWidth == "Full") {
                    $("#pageContents .panel").appendTo($("#pageContents"));
                    $splitScreen.remove();
                } else {
                    $textHolder.html(x_addLineBreaks(x_currentPageXML.getAttribute("instruction")));

                    var textAlign = x_currentPageXML.getAttribute("align");
                    if (textAlign != "Right") {
                        if (panelWidth == "Small") {
                            $splitScreen.addClass("large");
                        } else if (panelWidth == "Large") {
                            $splitScreen.addClass("small");
                        } else {
                            $splitScreen.addClass("medium");
                        }
                    } else {
                        $textHolder
                            .removeClass("left")
                            .addClass("right")
                            .appendTo($splitScreen);
                        $("#infoHolder")
                            .removeClass("right")
                            .addClass("left");
                        if (panelWidth == "Small") {
                            $splitScreen.addClass("medium");
                        } else if (panelWidth == "Large") {
                            $splitScreen.addClass("large");
                        } else {
                            $splitScreen.addClass("large");
                        }
                    }
                }

                var $pageContents = $("#pageContents");

                var $textHolder = $("#textHolder");
                var instruction = x_currentPageXML.getAttribute("instruction");
                $textHolder.html(instruction);

                var $question = $("#infoHolder #question");
                var question = x_currentPageXML.getAttribute("wrongText");
                question = $("<div>").html(question).text().trim();
                $question.html(question);

                var answer = x_currentPageXML.getAttribute("answer");
                answer = $("<div>").html(answer).text().trim();

                var $correctOrNot = $("#infoHolder #correctOrNot");
                var correct = "Good job";

                var $feedback = $("#infoHolder #feedback");
                var feedback = x_currentPageXML.getAttribute("feedback");
                feedback = $("<div>").html(feedback).text().trim();

                var $answer = $("#infoHolder #answer");

                var showAnswer =  x_currentPageXML.getAttribute("showAnswers");

                //Translation
                var incorrect = x_currentPageXML.getAttribute("textWrong");

                var incompleet = x_currentPageXML.getAttribute("textIncomplete");

                var correct = x_currentPageXML.getAttribute("textRight");

                var checkButtonTxt = x_currentPageXML.getAttribute("checkBtn");

                var resultLabel = x_currentPageXML.getAttribute("resultLabel");

                var feedbackLabel = x_currentPageXML.getAttribute("feedbackLabel");

                var answerLabel = x_currentPageXML.getAttribute("answerLabel");


                // if (checkBtnTxt == undefined) {
                //     checkBtnTxt = "Check";
                // }
                $("#checkButton")
                    .button({
                        label: checkButtonTxt
                    })
                    .click(function () {
                        $(checkButton).button("disable");
                        //get value of text area
                        var input = $(".answer textarea").val();
                        // decide if it is correct or not
                        $correctOrNot.append("<h3>"+resultLabel+"</h3>");
                        if(input === answer){
                            $correctOrNot.append(correct)
                        }
                        if(input === ""){
                            $correctOrNot.append(incompleet);
                        }else if(input !== answer){
                            $correctOrNot.append(incorrect)
                        }

                        // show feedback
                        $feedback.append("<h3>" + feedbackLabel + "</h3>");
                        $feedback.append(feedback);

                        if(showAnswer === null || showAnswer === true){

                            $answer.append("<h3>" + answerLabel + "</h3>");
                            $answer.append(answer)
                        }

                    });


                x_pageLoaded();
            }
        };

    textCorrection.init();

</script>



<div id="pageContents">
    <div class="splitScreen">
        <div id="textHolder" class="left"></div>
        <div id="infoHolder" class="right">
            <div id="mainPanel" class="panel">
                <h3 class="titleQuestion">
                    <legend id="question"></legend>
                </h3>
                <div id="optionHolder">
                    <div class="answer"><textarea rows="4" cols="50"></textarea></div>
                </div>
                <button id="checkButton"></button>
                <div id="correctOrNot">

                </div>
                <div id="feedback">

                </div>
                <div id ="answer">

                </div>
            </div>
        </div>
    </div>
</div>
